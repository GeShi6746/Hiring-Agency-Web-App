<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace = "com.example.hiringagency.DAO.HPMapper">
    <insert id="setHP" parameterType="com.example.hiringagency.domain.entity.HealthcareJobApplication">
        insert into HealthcareJobApplication(`firstName`, `lastName`,`gender`, `dateOfBirth`, `ssn`,`serviceType`, `degree`, `educationQualifications`, `yearsExperience`,`postalAddress`, `phoneNumber`, `email`,`active`, `jobAdvertisementId`)
        values (#{firstName}, #{lastName}, #{gender}, #{dateOfBirth}, #{ssn}, #{serviceType}, #{degree}, #{educationQualifications}, #{yearsExperience}, #{postalAddress}, #{phoneNumber}, #{email}, 1, #{jobAdvertisementId})
    </insert>

    <!-- HP applicants -->
    <select id="selectAllHPs" resultType="com.example.hiringagency.domain.entity.HealthcareJobApplication">
        select *
        from HealthcareJobApplication hja left join JobAdvertisements ja on hja.jobAdvertisementId = ja.jobAdvertisementId
        where hja.degree >= ja.educationRequirement and hja.active = 1
    </select>

    <select id="selectHPByJobId" resultType="com.example.hiringagency.domain.entity.HealthcareJobApplication">
        select *
        from HealthcareJobApplication hja left join JobAdvertisements ja on hja.jobAdvertisementId = ja.jobAdvertisementId
        where hja.degree >= ja.educationRequirement and hja.active = 1 and hja.jobAdvertisementId = #{jobAdvertisementId}
    </select>

    <select id="selectAllSsn" resultType="com.example.hiringagency.domain.entity.HealthcareJobApplication">
        select *
        from HealthcareJobApplication
        where userId is not null
    </select>

    <select id="selectEntries" resultType="com.example.hiringagency.domain.entity.ServiceEntries">
        select *
        from ServiceEntries
        where hpId = #{userId}
    </select>

    <update id="updateHour" parameterType="com.example.hiringagency.domain.entity.ServiceEntries">
        update ServiceEntries
        set startTime = #{startTime} and endTime = #{endTime} and completedFlag = 1
        where serviceEntryId = #{serviceEntryId}
    </update>
</mapper>